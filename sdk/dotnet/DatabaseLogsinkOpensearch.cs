// *** WARNING: this file was generated by pulumi-language-dotnet. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

using System;
using System.Collections.Generic;
using System.Collections.Immutable;
using System.Threading.Tasks;
using Pulumi.Serialization;

namespace Pulumi.DigitalOcean
{
    /// <summary>
    /// Provides a DigitalOcean database logsink resource allowing you to forward logs from a managed database cluster to an external OpenSearch cluster or Elasticsearch endpoint.
    /// 
    /// This resource is compatible with both OpenSearch and Elasticsearch endpoints due to API compatibility. You can use this resource to connect to either service.
    /// 
    /// This resource supports the following DigitalOcean managed database engines:
    /// 
    /// * PostgreSQL
    /// * MySQL
    /// * Kafka
    /// * Valkey
    /// 
    /// **Note**: MongoDB databases use a different log forwarding mechanism and require Datadog logsinks (not currently available in this provider).
    /// 
    /// ## Example Usage
    /// 
    /// ### Basic OpenSearch configuration
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using Pulumi;
    /// using DigitalOcean = Pulumi.DigitalOcean;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var postgres_example = new DigitalOcean.DatabaseCluster("postgres-example", new()
    ///     {
    ///         Name = "example-postgres-cluster",
    ///         Engine = "pg",
    ///         Version = "15",
    ///         Size = DigitalOcean.DatabaseSlug.DB_1VPCU1GB,
    ///         Region = DigitalOcean.Region.NYC1,
    ///         NodeCount = 1,
    ///     });
    /// 
    ///     var example = new DigitalOcean.DatabaseLogsinkOpensearch("example", new()
    ///     {
    ///         ClusterId = postgres_example.Id,
    ///         Name = "opensearch-logs",
    ///         Endpoint = "https://opensearch.example.com:9200",
    ///         IndexPrefix = "db-logs",
    ///         IndexDaysMax = 7,
    ///     });
    /// 
    /// });
    /// ```
    /// 
    /// ### OpenSearch with authentication and CA certificate
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using Pulumi;
    /// using DigitalOcean = Pulumi.DigitalOcean;
    /// using Std = Pulumi.Std;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var example_secure = new DigitalOcean.DatabaseLogsinkOpensearch("example-secure", new()
    ///     {
    ///         ClusterId = postgres_example.Id,
    ///         Name = "opensearch-secure",
    ///         Endpoint = "https://user:password@opensearch.example.com:9200",
    ///         IndexPrefix = "secure-logs",
    ///         IndexDaysMax = 14,
    ///         CaCert = Std.File.Invoke(new()
    ///         {
    ///             Input = "/path/to/ca.pem",
    ///         }).Apply(invoke =&gt; invoke.Result),
    ///         TimeoutSeconds = 30,
    ///     });
    /// 
    /// });
    /// ```
    /// 
    /// ### Elasticsearch endpoint configuration
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using Pulumi;
    /// using DigitalOcean = Pulumi.DigitalOcean;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var elasticsearch = new DigitalOcean.DatabaseLogsinkOpensearch("elasticsearch", new()
    ///     {
    ///         ClusterId = postgres_example.Id,
    ///         Name = "elasticsearch-logs",
    ///         Endpoint = "https://elasticsearch.example.com:9243",
    ///         IndexPrefix = "es-logs",
    ///         IndexDaysMax = 30,
    ///     });
    /// 
    /// });
    /// ```
    /// 
    /// ### MySQL to OpenSearch configuration
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using Pulumi;
    /// using DigitalOcean = Pulumi.DigitalOcean;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var mysql_example = new DigitalOcean.DatabaseCluster("mysql-example", new()
    ///     {
    ///         Name = "example-mysql-cluster",
    ///         Engine = "mysql",
    ///         Version = "8",
    ///         Size = DigitalOcean.DatabaseSlug.DB_1VPCU1GB,
    ///         Region = DigitalOcean.Region.NYC1,
    ///         NodeCount = 1,
    ///     });
    /// 
    ///     var mysql = new DigitalOcean.DatabaseLogsinkOpensearch("mysql", new()
    ///     {
    ///         ClusterId = mysql_example.Id,
    ///         Name = "mysql-logs",
    ///         Endpoint = "https://opensearch.example.com:9200",
    ///         IndexPrefix = "mysql-logs",
    ///         IndexDaysMax = 7,
    ///     });
    /// 
    /// });
    /// ```
    /// 
    /// ## Important Notes
    /// 
    /// ### Elasticsearch Compatibility
    /// This resource works with both OpenSearch and Elasticsearch endpoints due to their API compatibility. Use the same resource type regardless of whether you're connecting to OpenSearch or Elasticsearch.
    /// 
    /// ### Managed OpenSearch with Trusted Sources
    /// When forwarding logs to a DigitalOcean Managed OpenSearch cluster with trusted sources enabled, you must manually allow-list the IP addresses of your database cluster nodes.
    /// 
    /// ### Authentication
    /// Include authentication credentials directly in the endpoint URL using the format `https://username:password@host:port`. Alternatively, configure authentication on your OpenSearch/Elasticsearch cluster to accept connections from your database cluster's IP addresses.
    /// 
    /// ## Import
    /// 
    /// Database logsink OpenSearch resources can be imported using the composite ID format `cluster_id,logsink_id`. For example:
    /// 
    /// ```sh
    /// $ pulumi import digitalocean:index/databaseLogsinkOpensearch:DatabaseLogsinkOpensearch example 245bcfd0-7f31-4ce6-a2bc-475a116cca97,f38db7c8-1f31-4ce6-a2bc-475a116cca97
    /// ```
    /// 
    /// **Note**: The cluster ID and logsink ID must be separated by a comma.
    /// </summary>
    [DigitalOceanResourceType("digitalocean:index/databaseLogsinkOpensearch:DatabaseLogsinkOpensearch")]
    public partial class DatabaseLogsinkOpensearch : global::Pulumi.CustomResource
    {
        /// <summary>
        /// CA certificate for TLS verification in PEM format. Can be specified using `file()` function. This field is marked as sensitive.
        /// </summary>
        [Output("caCert")]
        public Output<string?> CaCert { get; private set; } = null!;

        /// <summary>
        /// UUID of the source database cluster that will forward logs.
        /// </summary>
        [Output("clusterId")]
        public Output<string> ClusterId { get; private set; } = null!;

        /// <summary>
        /// HTTPS URL to the OpenSearch or Elasticsearch cluster (e.g., `https://host:port`). **Note**: Only HTTPS URLs are supported.
        /// </summary>
        [Output("endpoint")]
        public Output<string> Endpoint { get; private set; } = null!;

        /// <summary>
        /// Maximum number of days to retain indices. Must be 1 or greater.
        /// </summary>
        [Output("indexDaysMax")]
        public Output<int?> IndexDaysMax { get; private set; } = null!;

        /// <summary>
        /// Prefix for the indices where logs will be stored.
        /// </summary>
        [Output("indexPrefix")]
        public Output<string> IndexPrefix { get; private set; } = null!;

        /// <summary>
        /// The unique identifier for the logsink as returned by the DigitalOcean API.
        /// </summary>
        [Output("logsinkId")]
        public Output<string> LogsinkId { get; private set; } = null!;

        /// <summary>
        /// Display name for the logsink. **Note**: This is immutable; changing it will force recreation of the resource.
        /// </summary>
        [Output("name")]
        public Output<string> Name { get; private set; } = null!;

        /// <summary>
        /// Request timeout for log deliveries in seconds. Must be 1 or greater.
        /// </summary>
        [Output("timeoutSeconds")]
        public Output<int?> TimeoutSeconds { get; private set; } = null!;


        /// <summary>
        /// Create a DatabaseLogsinkOpensearch resource with the given unique name, arguments, and options.
        /// </summary>
        ///
        /// <param name="name">The unique name of the resource</param>
        /// <param name="args">The arguments used to populate this resource's properties</param>
        /// <param name="options">A bag of options that control this resource's behavior</param>
        public DatabaseLogsinkOpensearch(string name, DatabaseLogsinkOpensearchArgs args, CustomResourceOptions? options = null)
            : base("digitalocean:index/databaseLogsinkOpensearch:DatabaseLogsinkOpensearch", name, args ?? new DatabaseLogsinkOpensearchArgs(), MakeResourceOptions(options, ""))
        {
        }

        private DatabaseLogsinkOpensearch(string name, Input<string> id, DatabaseLogsinkOpensearchState? state = null, CustomResourceOptions? options = null)
            : base("digitalocean:index/databaseLogsinkOpensearch:DatabaseLogsinkOpensearch", name, state, MakeResourceOptions(options, id))
        {
        }

        private static CustomResourceOptions MakeResourceOptions(CustomResourceOptions? options, Input<string>? id)
        {
            var defaultOptions = new CustomResourceOptions
            {
                Version = Utilities.Version,
                AdditionalSecretOutputs =
                {
                    "caCert",
                },
            };
            var merged = CustomResourceOptions.Merge(defaultOptions, options);
            // Override the ID if one was specified for consistency with other language SDKs.
            merged.Id = id ?? merged.Id;
            return merged;
        }
        /// <summary>
        /// Get an existing DatabaseLogsinkOpensearch resource's state with the given name, ID, and optional extra
        /// properties used to qualify the lookup.
        /// </summary>
        ///
        /// <param name="name">The unique name of the resulting resource.</param>
        /// <param name="id">The unique provider ID of the resource to lookup.</param>
        /// <param name="state">Any extra arguments used during the lookup.</param>
        /// <param name="options">A bag of options that control this resource's behavior</param>
        public static DatabaseLogsinkOpensearch Get(string name, Input<string> id, DatabaseLogsinkOpensearchState? state = null, CustomResourceOptions? options = null)
        {
            return new DatabaseLogsinkOpensearch(name, id, state, options);
        }
    }

    public sealed class DatabaseLogsinkOpensearchArgs : global::Pulumi.ResourceArgs
    {
        [Input("caCert")]
        private Input<string>? _caCert;

        /// <summary>
        /// CA certificate for TLS verification in PEM format. Can be specified using `file()` function. This field is marked as sensitive.
        /// </summary>
        public Input<string>? CaCert
        {
            get => _caCert;
            set
            {
                var emptySecret = Output.CreateSecret(0);
                _caCert = Output.Tuple<Input<string>?, int>(value, emptySecret).Apply(t => t.Item1);
            }
        }

        /// <summary>
        /// UUID of the source database cluster that will forward logs.
        /// </summary>
        [Input("clusterId", required: true)]
        public Input<string> ClusterId { get; set; } = null!;

        /// <summary>
        /// HTTPS URL to the OpenSearch or Elasticsearch cluster (e.g., `https://host:port`). **Note**: Only HTTPS URLs are supported.
        /// </summary>
        [Input("endpoint", required: true)]
        public Input<string> Endpoint { get; set; } = null!;

        /// <summary>
        /// Maximum number of days to retain indices. Must be 1 or greater.
        /// </summary>
        [Input("indexDaysMax")]
        public Input<int>? IndexDaysMax { get; set; }

        /// <summary>
        /// Prefix for the indices where logs will be stored.
        /// </summary>
        [Input("indexPrefix", required: true)]
        public Input<string> IndexPrefix { get; set; } = null!;

        /// <summary>
        /// Display name for the logsink. **Note**: This is immutable; changing it will force recreation of the resource.
        /// </summary>
        [Input("name")]
        public Input<string>? Name { get; set; }

        /// <summary>
        /// Request timeout for log deliveries in seconds. Must be 1 or greater.
        /// </summary>
        [Input("timeoutSeconds")]
        public Input<int>? TimeoutSeconds { get; set; }

        public DatabaseLogsinkOpensearchArgs()
        {
        }
        public static new DatabaseLogsinkOpensearchArgs Empty => new DatabaseLogsinkOpensearchArgs();
    }

    public sealed class DatabaseLogsinkOpensearchState : global::Pulumi.ResourceArgs
    {
        [Input("caCert")]
        private Input<string>? _caCert;

        /// <summary>
        /// CA certificate for TLS verification in PEM format. Can be specified using `file()` function. This field is marked as sensitive.
        /// </summary>
        public Input<string>? CaCert
        {
            get => _caCert;
            set
            {
                var emptySecret = Output.CreateSecret(0);
                _caCert = Output.Tuple<Input<string>?, int>(value, emptySecret).Apply(t => t.Item1);
            }
        }

        /// <summary>
        /// UUID of the source database cluster that will forward logs.
        /// </summary>
        [Input("clusterId")]
        public Input<string>? ClusterId { get; set; }

        /// <summary>
        /// HTTPS URL to the OpenSearch or Elasticsearch cluster (e.g., `https://host:port`). **Note**: Only HTTPS URLs are supported.
        /// </summary>
        [Input("endpoint")]
        public Input<string>? Endpoint { get; set; }

        /// <summary>
        /// Maximum number of days to retain indices. Must be 1 or greater.
        /// </summary>
        [Input("indexDaysMax")]
        public Input<int>? IndexDaysMax { get; set; }

        /// <summary>
        /// Prefix for the indices where logs will be stored.
        /// </summary>
        [Input("indexPrefix")]
        public Input<string>? IndexPrefix { get; set; }

        /// <summary>
        /// The unique identifier for the logsink as returned by the DigitalOcean API.
        /// </summary>
        [Input("logsinkId")]
        public Input<string>? LogsinkId { get; set; }

        /// <summary>
        /// Display name for the logsink. **Note**: This is immutable; changing it will force recreation of the resource.
        /// </summary>
        [Input("name")]
        public Input<string>? Name { get; set; }

        /// <summary>
        /// Request timeout for log deliveries in seconds. Must be 1 or greater.
        /// </summary>
        [Input("timeoutSeconds")]
        public Input<int>? TimeoutSeconds { get; set; }

        public DatabaseLogsinkOpensearchState()
        {
        }
        public static new DatabaseLogsinkOpensearchState Empty => new DatabaseLogsinkOpensearchState();
    }
}
